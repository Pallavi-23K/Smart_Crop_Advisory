{% extends 'base.html' %}

{% block content %}

<!-- Optional icons and local styles -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
<link href="{{ url_for('static', filename='bot.css') }}" rel="stylesheet" />
<style>
  .hero { background: linear-gradient(120deg, #28a745 0%, #218838 100%); color: #fff; padding: 60px 0 40px 0; border-radius: 0 0 30px 30px; box-shadow: 0 4px 24px rgba(40,167,69,0.1); margin-bottom: 40px; }
  .hero-title { font-size: 2.4rem; font-weight: 700; }
  .card-custom { border: none; border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); transition: transform .18s ease, box-shadow .18s ease; }
  .card-custom:hover { transform: translateY(-8px); box-shadow: 0 18px 40px rgba(0,0,0,0.12); }
  .icon-grad { height:64px; width:64px; display:flex; align-items:center; justify-content:center; border-radius:50%; margin-bottom:12px; }
  /* keep cards visually aligned: ensure market card body height matches others */
  .card .market-badges { min-height: 48px; align-items: center; }
  .market-badge { font-size: 0.85rem; padding: .35rem .6rem; }

  /* Icon gradient palettes matching bootstrap theme colors */
  .icon-grad.bg-1 { background: linear-gradient(135deg,#0d6efd,#0b5ed7); }
  .icon-grad.bg-2 { background: linear-gradient(135deg,#198754,#146c43); }
  .icon-grad.bg-3 { background: linear-gradient(135deg,#0dcaf0,#0aa2bd); }
  .icon-grad.bg-4 { background: linear-gradient(135deg,#0dcaf0,#20c997); }
  .icon-grad.bg-5 { background: linear-gradient(135deg,#ffc107,#ffb020); }
  .icon-grad.bg-6 { background: linear-gradient(135deg,#6c757d,#495057); }
  .icon-grad.bg-7 { background: linear-gradient(135deg,#6610f2,#5a0fd1); }
  .icon-grad.bg-8 { background: linear-gradient(135deg,#20c997,#198754); }

  /* Button hover/press subtle lift for all action buttons */
  .btn-hover-effect { transition: transform .12s ease, box-shadow .12s ease; }
  .btn-hover-effect:hover, .btn-hover-effect:focus { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); }

  /* Small responsive tweaks */
  @media (max-width: 575px) {
    .hero-title { font-size: 1.6rem; }
  }
</style>

{% if not session.get('user_id') %}
<!-- Simple hero for anonymous users (no images) -->
<section class="hero">
  <div style="padding: 56px 0; border-radius: 0 0 30px 30px; background: linear-gradient(120deg, #28a745 0%, #218838 100%); color: #fff;">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h2 class="hero-title">{{ t('Empowering Indian Agriculture') }}</h2>
          <p class="lead mb-3">{{ t('Crop Intelligence, Schemes, Weather and More â€” all in your language.') }}</p>
        </div>
        <div class="col-md-4 text-md-end">
          <a href="{{ url_for('signup') }}" class="btn btn-light btn-lg">{{ t('Get Started') }}</a>
        </div>
      </div>
    </div>
  </div>

  
</section>
{% endif %}

  <div class="container" id="dashboard">
  {% if session.get('user_id') %}
  <div class="row g-4">
    <div class="col-md-6 col-lg-4">
        <div class="card card-custom h-100 text-center p-3">
          <div class="icon-grad bg-1 mx-auto"><i class="bi bi-flower2 fs-2 text-white"></i></div>
          <h5 class="mt-2">{{ t('Crop Recommendation') }}</h5>
          <p class="text-muted">{{ t('Get crops suggested for your soil and local weather conditions.') }}</p>
          <button class="btn btn-primary btn-hover-effect" data-bs-toggle="modal" data-bs-target="#chatModal">{{ t('Open Chatbot') }}</button>
        </div>
    </div>

    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-7 mx-auto"><i class="bi bi-bug fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Pest & Disease Detection') }}</h5>
        <p class="text-muted">{{ t('Upload leaf images to detect plant pests and diseases using AI.') }}</p>
        <a href="{{ url_for('pest') }}" class="btn btn-danger btn-hover-effect">{{ t('Open Advisory') }}</a>
      </div>
    </div>

    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-4 mx-auto"><i class="bi bi-book-half fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Learning Hub') }}</h5>
        <p class="text-muted">{{ t('Watch farming videos, read guides and best practices in your language.') }}</p>
        <a href="{{ url_for('farmhub') }}" class="btn btn-info btn-hover-effect">{{ t('Explore') }}</a>
      </div>
    </div>

    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-5 mx-auto"><i class="bi bi-bank fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Govt Schemes') }}</h5>
        <p class="text-muted">{{ t('See all available schemes and incentives for farmers.') }}</p>
        <a href="{{ url_for('schemes_page') }}" class="btn btn-warning btn-hover-effect">{{ t('Browse Schemes') }}</a>
      </div>
    </div>

    

  <div class="col-md-6 col-lg-4">
  <div class="card card-custom h-100 text-center p-3">
    <div class="icon-grad bg-8 mx-auto">
      <i class="bi bi-currency-exchange fs-2 text-white"></i>
    </div>
    <h5 class="mt-2">{{ t('Market Analysis') }}</h5>
    <p class="text-muted">{{ t('Live crop price snapshots to help with quick selling decisions.') }}</p>
    <button id="openMarketDetails" class="btn btn-success btn-hover-effect">Open Market</button>
  </div>
</div>



    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-3 mx-auto"><i class="bi bi-cloud-sun fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Weather Service') }}</h5>
        <p class="text-muted">{{ t('Check hyper-local, real-time weather updates for any village or city.') }}</p>
        <a href="{{ url_for('weather_page') }}" class="btn btn-secondary btn-hover-effect">{{ t('See Weather') }}</a>
      </div>
    </div>

    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-6 mx-auto"><i class="bi bi-people-fill fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Women Farmer Support') }}</h5>
        <p class="text-muted">{{ t('Find help, helplines and join the women farmers community groups.') }}</p>
        <a href="{{ url_for('women_page') }}" class="btn btn-dark btn-hover-effect">{{ t('Join Community') }}</a>
      </div>
    </div>

    <div class="col-md-6 col-lg-4">
      <div class="card card-custom h-100 text-center p-3">
        <div class="icon-grad bg-2 mx-auto"><i class="bi bi-droplet-half fs-2 text-white"></i></div>
        <h5 class="mt-2">{{ t('Soil Analysis') }}</h5>
        <p class="text-muted">{{ t('Analyze your soil health, pH, and nutrients for crop recommendations.') }}</p>
        <a href="{{ url_for('soil_analysis_page') }}" class="btn btn-dark btn-hover-effect text-white">{{ t('Analyze Soil') }}</a>
      </div>
    </div>

  </div>
  {% else %}
  <div class="row">
    <div class="col-12 text-center py-5">
      <h3>{{ t('Welcome to Kissan Connect') }}</h3>
      <p class="lead">{{ t('Sign up or login to access personalized crop recommendations, soil analysis, weather and schemes.') }}</p>
      <a href="{{ url_for('signup') }}" class="btn btn-primary me-2">{{ t('Sign Up') }}</a>
      <a href="{{ url_for('login') }}" class="btn btn-outline-primary">{{ t('Login') }}</a>
    </div>
  </div>
  {% endif %}

  <footer class="text-center text-muted small pt-5 pb-3">&copy; 2025 Smart Crop Advisory | {{ t('Made for Indian Farmers') }}</footer>
</div>

<!-- Chatbot Modal -->
<div class="modal fade" id="chatModal" tabindex="-1" aria-labelledby="chatModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="chatModalLabel">{{ t('CropAdvisor Chatbot') }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">{{ t('Farmer Name') }}</label>
            <input id="farmer_name" class="form-control" placeholder="{{ t('Your full name') }}">
          </div>
          <div class="col-md-6">
            <label class="form-label">{{ t('Phone') }}</label>
            <input id="farmer_phone" class="form-control" placeholder="{{ t('Mobile number') }}">
          </div>
          <div class="col-md-6">
            <label class="form-label">{{ t('Soil type') }}</label>
            <select id="soil_select" class="form-select">
              <option value="loamy">{{ t('Loamy') }}</option>
              <option value="clay">{{ t('Clay') }}</option>
              <option value="sandy">{{ t('Sandy') }}</option>
              <option value="other">{{ t('Other') }}</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">{{ t('Preferred language') }}</label>
            <select id="lang_select" class="form-select">
              <option value="english" selected>English</option>
              <option value="hindi">Hindi</option>
              <option value="kannada">Kannada</option>
              <option value="telugu">Telugu</option>
              <option value="tamil">Tamil</option>
              <option value="malayalam">Malayalam</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">{{ t('Latitude') }}</label>
            <input id="chat_lat" class="form-control" placeholder="e.g. 12.9716">
          </div>
          <div class="col-md-6">
            <label class="form-label">{{ t('Longitude') }}</label>
            <input id="chat_lon" class="form-control" placeholder="e.g. 77.5946">
          </div>
          <div class="col-12">
            <label class="form-label">{{ t('Field size (acres)') }}</label>
            <input id="field_size" class="form-control" placeholder="e.g. 1.5">
          </div>
          <div class="col-12">
            <label class="form-label">{{ t('Any previous crop / notes') }}</label>
            <input id="prev_crop" class="form-control" placeholder="{{ t('Optional notes') }}">
          </div>
          <div class="col-12 text-end mt-2">
            <button id="chatAsk" class="btn btn-success">{{ t('Ask') }}</button>
            <button id="chatUseLocation" class="btn btn-outline-secondary ms-2">{{ t('Use my location') }}</button>
          </div>
          <div class="col-12 mt-3">
            <div id="chatResponse" class="p-3" style="background:#f8fafb;border-radius:8px;min-height:80px"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Market UI removed -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='bot.js') }}"></script>

<!-- Market Modal (re-added) -->
<div class="modal fade" id="marketModal" tabindex="-1" aria-labelledby="marketModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="marketModalLabel">{{ t('Market Prices') }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="marketBody">{{ t('Loading prices...') }}</div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
